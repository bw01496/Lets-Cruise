{"ast":null,"code":"var _jsxFileName = \"/Users/jinzo/Desktop/projects/outdoorsthings/src/components/MyCart.js\";\nimport React, { useEffect, useState } from \"react\";\nimport { Link, Routes, useNavigate } from \"react-router-dom\";\nimport { destroyCart, getCartByUser } from \"../api\"; // const { getAllCheckoutsByUserId } = require(\"../db\");\n\nconst MyCart = ({\n  userId,\n  token,\n  setMyProducts,\n  myProducts,\n  products,\n  setCheckout,\n  setCartItems\n}) => {\n  let totalPrice = 0;\n  const [firstName, setFirstName] = useState(\"\");\n  const [lastName, setLastName] = useState(\"\");\n  const [street, setStreet] = useState(\"\");\n  const [city, setCity] = useState(\"\");\n  const [state, setState] = useState(\"\");\n  const [zip, setZip] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [creditCardNumber, setCreditCardNumber] = useState(\"\");\n  const [creditCardExp, setCreditCardExp] = useState(\"\");\n  const [creditValidationNumber, setCreditValidationNumber] = useState(\"\");\n  const [quantity, setQuantity] = useState();\n  const [total, setTotal] = useState(0);\n  console.log(\">>>>>\", total);\n\n  const deleteCart = async () => {\n    if (userId) {\n      await destroyCart(userId, token);\n      const usersCart = await getCartByUser(userId, token);\n      setCartItems(usersCart);\n    } else {\n      const localCart = localStorage.setItem(\"temporary-cart\", JSON.strigify([]));\n      setCartItems([]);\n    }\n\n    setTotal(0);\n  }; // const getCartQuantity = async () => {\n  //   try {\n  //     const response = await fetch(\n  //       `http://localhost:3000/api/orders/cart/${userId}`\n  //     );\n  //     const data = await response.json();\n  //     console.log('data from MyCart', data)\n  //     for(var i = 0; i < data.length; i++){\n  //       tempCart[data[i].title] = 1;\n  //     }\n  //     for(var i = 0; i < data.length; i++){\n  //       tempCart[data[i].title] = tempCart[data[i].title] + 1;\n  //     }\n  //     console.log('tempCart',  tempCart);\n  //     let tempArray = [];\n  //     var tempCartKeys = Object.keys(tempCart);\n  //     var tempCartValues = Object.values(tempCart);\n  //     for(var i = 0; i < tempCartKeys.length; i++){\n  //       var objKey = tempCartKeys[i];\n  //       tempArray.push({\n  //         [objKey]: tempCartValues[i]\n  //       })\n  //     }\n  //     setMyCartQuantity(tempArray)\n  //   } catch (error) {\n  //     console.error(error);\n  //   }\n  // };\n  // useEffect(() => {\n  //    getCartQuantity();\n  // }, []);\n\n\n  function getTotal() {\n    myProducts.map(element => {\n      totalPrice = Number(totalPrice) + Number(element.price);\n      setTotal(totalPrice);\n    });\n  }\n\n  const getMyProducts = async () => {\n    try {\n      const response = await fetch(`http://localhost:3000/api/orders/cart/${userId}`);\n      const data = await response.json();\n      setMyProducts(data);\n      getTotal();\n      setTotal(totalPrice);\n    } catch (error) {\n      console.error(error);\n    }\n  };\n\n  useEffect(() => {\n    getMyProducts();\n  }, []);\n  console.log(\"from my cart\", myProducts);\n\n  const submitOrder = async event => {\n    event.preventDefault(); // Logged in\n\n    if (userData.id) {\n      const checkout = await submitCheckout({\n        userId: userData.id,\n        firstName,\n        lastName,\n        street,\n        city,\n        state,\n        zip,\n        phone,\n        creditCardNumber,\n        creditCardExp,\n        creditValidationNumber,\n        orders: cart\n      }, token);\n      const usersCart = await getCartByUser(userData.id, token);\n      setCart(usersCart);\n      const usersCheckout = await getAllCheckoutsByUserId(userData.id, token);\n      setCheckout(usersCheckout);\n      setSuccess(`Purchase was a success!`);\n      handleClick(); // Guest or logged out\n    } else {\n      const checkout = await submitGuestCheckout({\n        firstName,\n        lastName,\n        street,\n        city,\n        state,\n        zip,\n        phone,\n        creditCardNumber,\n        creditCardExp,\n        creditValidationNumber,\n        orders: cart\n      }, token);\n      const localCart = localStorage.setItem(\"capstone-cart\", JSON.stringify([]));\n      setCart([]);\n      setSuccess(`Purchase was a success!`);\n      handleClick();\n    }\n\n    setTotalCartCost(0);\n  };\n\n  return /*#__PURE__*/React.createElement(React.Fragment, null, /*#__PURE__*/React.createElement(\"h1\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 175,\n      columnNumber: 7\n    }\n  }, \"My Cart\"), myProducts ? myProducts.map(item => /*#__PURE__*/React.createElement(\"div\", {\n    className: \"cart\",\n    key: item.id,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 178,\n      columnNumber: 11\n    }\n  }, /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 179,\n      columnNumber: 13\n    }\n  }, item.title, \" \", \"$\", item.price, \" \", item.orderQuantity, \" \", /*#__PURE__*/React.createElement(\"button\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 181,\n      columnNumber: 49\n    }\n  }, \"+\"), \" \", /*#__PURE__*/React.createElement(\"button\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 182,\n      columnNumber: 15\n    }\n  }, \"-\")))) : /*#__PURE__*/React.createElement(\"div\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 187,\n      columnNumber: 9\n    }\n  }, \"Cart is Empty\"), /*#__PURE__*/React.createElement(\"h5\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 189,\n      columnNumber: 7\n    }\n  }, \"Total Cost: \", \"$\", total), /*#__PURE__*/React.createElement(\"button\", {\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 193,\n      columnNumber: 7\n    }\n  }, \"Edit Cart\"), /*#__PURE__*/React.createElement(\"button\", {\n    onClick: () => deleteCart(),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 194,\n      columnNumber: 7\n    }\n  }, \"Delete Cart\"), /*#__PURE__*/React.createElement(\"form\", {\n    className: classes.form,\n    onSubmit: submitOrder,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 196,\n      columnNumber: 7\n    }\n  }, /*#__PURE__*/React.createElement(\"h3\", {\n    id: \"checkoutInstruction\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 197,\n      columnNumber: 9\n    }\n  }, \"Please Enter Your Shipping and Payment Information!\"), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"creditCardSection\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 200,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    className: classes.input,\n    type: \"text\",\n    placeholder: \"First\",\n    required: true,\n    value: firstName,\n    onChange: event => setFirstName(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 201,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    className: classes.input,\n    type: \"text\",\n    placeholder: \"Last\",\n    required: true,\n    value: lastName,\n    onChange: event => setLastName(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 209,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"creditCardSection\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 218,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    className: classes.input,\n    type: \"text\",\n    placeholder: \"street\",\n    required: true,\n    value: street,\n    onChange: event => setStreet(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 219,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    className: classes.input,\n    type: \"text\",\n    placeholder: \"City\",\n    required: true,\n    value: city,\n    onChange: event => setCity(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 227,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    className: classes.input,\n    type: \"text\",\n    placeholder: \"State\",\n    required: true,\n    value: state,\n    onChange: event => setState(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 235,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    className: classes.input,\n    type: \"text\",\n    placeholder: \"zip\",\n    required: true,\n    value: zip,\n    onChange: event => setZip(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 243,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    className: classes.input,\n    type: \"text\",\n    placeholder: \"Phone\",\n    required: true,\n    value: phone,\n    onChange: event => setPhone(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 251,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(\"div\", {\n    id: \"creditCardSection\",\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 260,\n      columnNumber: 9\n    }\n  }, /*#__PURE__*/React.createElement(TextField, {\n    className: classes.input,\n    type: \"text\",\n    placeholder: \"CC Number\",\n    required: true,\n    value: creditCardNumber,\n    onChange: event => setCreditCardNumber(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 261,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    className: classes.input,\n    type: \"text\",\n    placeholder: \"Expiration\",\n    required: true,\n    value: creditCardExp,\n    onChange: event => setCreditCardExp(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 269,\n      columnNumber: 11\n    }\n  }), /*#__PURE__*/React.createElement(TextField, {\n    className: classes.input,\n    type: \"text\",\n    placeholder: \"CVV# on Back\",\n    required: true,\n    value: creditValidationNumber,\n    onChange: event => setCreditValidationNumber(event.target.value),\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 277,\n      columnNumber: 11\n    }\n  })), /*#__PURE__*/React.createElement(Button, {\n    id: \"paymentSubmit\",\n    type: \"submit\",\n    variant: \"contained\",\n    className: classes.button,\n    __self: this,\n    __source: {\n      fileName: _jsxFileName,\n      lineNumber: 286,\n      columnNumber: 9\n    }\n  }, \"Submit Order\")));\n};\n\nexport default MyCart;","map":{"version":3,"sources":["/Users/jinzo/Desktop/projects/outdoorsthings/src/components/MyCart.js"],"names":["React","useEffect","useState","Link","Routes","useNavigate","destroyCart","getCartByUser","MyCart","userId","token","setMyProducts","myProducts","products","setCheckout","setCartItems","totalPrice","firstName","setFirstName","lastName","setLastName","street","setStreet","city","setCity","state","setState","zip","setZip","phone","setPhone","creditCardNumber","setCreditCardNumber","creditCardExp","setCreditCardExp","creditValidationNumber","setCreditValidationNumber","quantity","setQuantity","total","setTotal","console","log","deleteCart","usersCart","localCart","localStorage","setItem","JSON","strigify","getTotal","map","element","Number","price","getMyProducts","response","fetch","data","json","error","submitOrder","event","preventDefault","userData","id","checkout","submitCheckout","orders","cart","setCart","usersCheckout","getAllCheckoutsByUserId","setSuccess","handleClick","submitGuestCheckout","stringify","setTotalCartCost","item","title","orderQuantity","classes","form","input","target","value","button"],"mappings":"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","sourcesContent":["import React, { useEffect, useState } from \"react\";\n\nimport { Link, Routes, useNavigate } from \"react-router-dom\";\nimport { destroyCart, getCartByUser } from \"../api\";\n\n// const { getAllCheckoutsByUserId } = require(\"../db\");\nconst MyCart = ({\n  userId,\n  token,\n  setMyProducts,\n  myProducts,\n  products,\n  setCheckout,\n  setCartItems,\n}) => {\n  let totalPrice = 0;\n\n  const [firstName, setFirstName] = useState(\"\");\n  const [lastName, setLastName] = useState(\"\");\n  const [street, setStreet] = useState(\"\");\n  const [city, setCity] = useState(\"\");\n  const [state, setState] = useState(\"\");\n  const [zip, setZip] = useState(\"\");\n  const [phone, setPhone] = useState(\"\");\n  const [creditCardNumber, setCreditCardNumber] = useState(\"\");\n  const [creditCardExp, setCreditCardExp] = useState(\"\");\n  const [creditValidationNumber, setCreditValidationNumber] = useState(\"\");\n  const [quantity, setQuantity] = useState();\n  const [total, setTotal] = useState(0);\n  console.log(\">>>>>\", total);\n\n  const deleteCart = async () => {\n    if (userId) {\n      await destroyCart(userId, token);\n      const usersCart = await getCartByUser(userId, token);\n      setCartItems(usersCart);\n    } else {\n      const localCart = localStorage.setItem(\n        \"temporary-cart\",\n        JSON.strigify([])\n      );\n      setCartItems([]);\n    }\n\n    setTotal(0);\n  };\n\n  // const getCartQuantity = async () => {\n  //   try {\n  //     const response = await fetch(\n  //       `http://localhost:3000/api/orders/cart/${userId}`\n  //     );\n  //     const data = await response.json();\n\n  //     console.log('data from MyCart', data)\n\n  //     for(var i = 0; i < data.length; i++){\n  //       tempCart[data[i].title] = 1;\n  //     }\n\n  //     for(var i = 0; i < data.length; i++){\n  //       tempCart[data[i].title] = tempCart[data[i].title] + 1;\n  //     }\n\n  //     console.log('tempCart',  tempCart);\n  //     let tempArray = [];\n  //     var tempCartKeys = Object.keys(tempCart);\n  //     var tempCartValues = Object.values(tempCart);\n  //     for(var i = 0; i < tempCartKeys.length; i++){\n  //       var objKey = tempCartKeys[i];\n  //       tempArray.push({\n  //         [objKey]: tempCartValues[i]\n  //       })\n  //     }\n\n  //     setMyCartQuantity(tempArray)\n  //   } catch (error) {\n  //     console.error(error);\n  //   }\n  // };\n  // useEffect(() => {\n  //    getCartQuantity();\n  // }, []);\n\n  function getTotal() {\n    myProducts.map((element) => {\n      totalPrice = Number(totalPrice) + Number(element.price);\n      setTotal(totalPrice);\n    });\n  }\n  const getMyProducts = async () => {\n    try {\n      const response = await fetch(\n        `http://localhost:3000/api/orders/cart/${userId}`\n      );\n      const data = await response.json();\n      setMyProducts(data);\n      getTotal();\n      setTotal(totalPrice);\n    } catch (error) {\n      console.error(error);\n    }\n  };\n  useEffect(() => {\n    getMyProducts();\n  }, []);\n\n  console.log(\"from my cart\", myProducts);\n\n  const submitOrder = async (event) => {\n    event.preventDefault();\n\n    // Logged in\n    if (userData.id) {\n      const checkout = await submitCheckout(\n        {\n          userId: userData.id,\n          firstName,\n          lastName,\n          street,\n          city,\n          state,\n          zip,\n          phone,\n          creditCardNumber,\n          creditCardExp,\n          creditValidationNumber,\n          orders: cart,\n        },\n        token\n      );\n\n      const usersCart = await getCartByUser(userData.id, token);\n      setCart(usersCart);\n      const usersCheckout = await getAllCheckoutsByUserId(userData.id, token);\n      setCheckout(usersCheckout);\n\n      setSuccess(`Purchase was a success!`);\n      handleClick();\n\n      // Guest or logged out\n    } else {\n      const checkout = await submitGuestCheckout(\n        {\n          firstName,\n          lastName,\n          street,\n          city,\n          state,\n          zip,\n          phone,\n          creditCardNumber,\n          creditCardExp,\n          creditValidationNumber,\n          orders: cart,\n        },\n        token\n      );\n\n      const localCart = localStorage.setItem(\n        \"capstone-cart\",\n        JSON.stringify([])\n      );\n      setCart([]);\n\n      setSuccess(`Purchase was a success!`);\n      handleClick();\n    }\n\n    setTotalCartCost(0);\n  };\n\n  return (\n    <>\n      <h1>My Cart</h1>\n      {myProducts ? (\n        myProducts.map((item) => (\n          <div className=\"cart\" key={item.id}>\n            <h5>\n              {item.title} {\"$\"}\n              {item.price} {item.orderQuantity} <button>+</button>{\" \"}\n              <button>-</button>\n            </h5>\n          </div>\n        ))\n      ) : (\n        <div>Cart is Empty</div>\n      )}\n      <h5>\n        Total Cost: {\"$\"}\n        {total}\n      </h5>\n      <button>Edit Cart</button>\n      <button onClick={() => deleteCart()}>Delete Cart</button>\n\n      <form className={classes.form} onSubmit={submitOrder}>\n        <h3 id=\"checkoutInstruction\">\n          Please Enter Your Shipping and Payment Information!\n        </h3>\n        <div id=\"creditCardSection\">\n          <TextField\n            className={classes.input}\n            type=\"text\"\n            placeholder=\"First\"\n            required\n            value={firstName}\n            onChange={(event) => setFirstName(event.target.value)}\n          />\n          <TextField\n            className={classes.input}\n            type=\"text\"\n            placeholder=\"Last\"\n            required\n            value={lastName}\n            onChange={(event) => setLastName(event.target.value)}\n          />\n        </div>\n        <div id=\"creditCardSection\">\n          <TextField\n            className={classes.input}\n            type=\"text\"\n            placeholder=\"street\"\n            required\n            value={street}\n            onChange={(event) => setStreet(event.target.value)}\n          />\n          <TextField\n            className={classes.input}\n            type=\"text\"\n            placeholder=\"City\"\n            required\n            value={city}\n            onChange={(event) => setCity(event.target.value)}\n          />\n          <TextField\n            className={classes.input}\n            type=\"text\"\n            placeholder=\"State\"\n            required\n            value={state}\n            onChange={(event) => setState(event.target.value)}\n          />\n          <TextField\n            className={classes.input}\n            type=\"text\"\n            placeholder=\"zip\"\n            required\n            value={zip}\n            onChange={(event) => setZip(event.target.value)}\n          />\n          <TextField\n            className={classes.input}\n            type=\"text\"\n            placeholder=\"Phone\"\n            required\n            value={phone}\n            onChange={(event) => setPhone(event.target.value)}\n          />\n        </div>\n        <div id=\"creditCardSection\">\n          <TextField\n            className={classes.input}\n            type=\"text\"\n            placeholder=\"CC Number\"\n            required\n            value={creditCardNumber}\n            onChange={(event) => setCreditCardNumber(event.target.value)}\n          />\n          <TextField\n            className={classes.input}\n            type=\"text\"\n            placeholder=\"Expiration\"\n            required\n            value={creditCardExp}\n            onChange={(event) => setCreditCardExp(event.target.value)}\n          />\n          <TextField\n            className={classes.input}\n            type=\"text\"\n            placeholder=\"CVV# on Back\"\n            required\n            value={creditValidationNumber}\n            onChange={(event) => setCreditValidationNumber(event.target.value)}\n          />\n        </div>\n        <Button\n          id=\"paymentSubmit\"\n          type=\"submit\"\n          variant=\"contained\"\n          className={classes.button}\n        >\n          Submit Order\n        </Button>\n      </form>\n    </>\n  );\n};\n\nexport default MyCart;\n"]},"metadata":{},"sourceType":"module"}